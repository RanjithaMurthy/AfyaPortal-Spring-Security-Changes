<div class="modal fade" id="member_login_spring" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <script type="text/javascript">
        function onJoinInClicked(modelId)
        {
            $('#' + modelId).modal("hide");
            window.location.href = '#JoinIn';
        }
    </script>
    <div class="container">
        <div class="row">
            <div class="modal-dialog">
                <div class="modal-content modal-member mw370">
                    <div class="modal-header modal-header-member text-left xs-text-left">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="member_login_close_spring"><span aria-hidden="true">&times;</span></button>
                        <img src="/afya-portal/static/images/popup-logo2.png" alt="logo" class=""/>
                        <span class="modal-head mrm30" style="margin-left:50px">Member Login</span>
                    </div>
                    <div class="modal-body pd30">
                        <div style="display:none" class="login-error-box text-center">
                            <!--succe-box-->
                            <img src="/afya-portal/static/images/error-icon.png" alt="error-img"/> &nbsp;<span>Please fix the errors in the form.</span>
                        </div>
                        <form class="frm_member_login" id="frm_member_login" method="post" action="login">
                            <input type="hidden" name="JavaScriptEnabled" value="Y"/>
                            <!--<input type="hidden" name="j_password" id="j_password"/>
                            <input type="hidden" name="j_username" id="j_username"/>-->
                            <div class="form-group mb30">
                                <input type="text" class="form-control fsize" id="username_spring" name="username"
                                       placeholder="Username"/>
                            </div>
                            <div class="form-group mb30">
                                <input type="password" class="form-control fsize" id="password_spring" name="password"
                                       placeholder="Password" oncopy="return false;" onpaste="return false;" oncut="return false;"/>
                            </div>
                            <div class="modal-footer">
                                <div class="mb20">
                                    <button type="submit" class="btn btn-all mrm30" id="log_in_spring" name="log_in">Log In &nbsp;
                                        <i class="fa fa-chevron-right"></i>
                                    </button>
                                    <button type="button" class="btn btn-all-learn" name="sign_up_link" id="sign_up_link_spring" value="click here"
                                            ui-sref="JoinIn">
                                        Join in &nbsp;
                                        <i class="fa fa-chevron-right"></i>
                                    </button>
                                    <hr>
                                    <a href="#" data-toggle="modal" data-target="#member-forget-psd" class="link-log-in" onClick="$('#member_login_close').trigger('click')">Forgot Password</a>

                                </div>
                            </div>
                        </form>
                    </div>
                </div>

            </div>

        </div>
    </div>
</div>

<!-- member login Small modal start-->
<div class="modal fade" id="member_login_spring_ajax" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">

    <div class="container">
        <div class="row">
            <div class="modal-dialog">
                <div class="modal-content modal-member mw370">
                    <div class="modal-header modal-header-member text-left xs-text-left">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="member_login_close_spring_ajax"><span aria-hidden="true">&times;</span></button>
                        <img src="/afya-portal/static/images/popup-logo2.png" alt="logo" class=""/>
                        <span class="modal-head mrm30" style="margin-left:50px">Member Login</span>
                    </div>
                    <div class="modal-body pd30">
                        <div style="display:none" class="login-error-box text-center">
                            <!--succe-box-->
                            <img src="/afya-portal/static/images/error-icon.png" alt="error-img"/> &nbsp;<span>Please fix the errors in the form.</span>
                        </div>
                        <form id="loginform" name="loginform">
                            <div class="form-group mb30">
                                <div class="input-icon">
                                    <i class="fa fa-user"></i>
                                    <input type="text" class="form-control fsize" id="username" name="username" placeholder="Username"/>
                                </div>
                            </div>
                            <div class="form-group mb30">
                                <div class="input-icon">
                                    <i class="fa fa-key"></i>
                                    <input type="password" class="form-control fsize" id="password" name="password" placeholder="Password" oncopy="return false;" onpaste="return false;" oncut="return false;"/>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <div class="mb20">
                                    <button type="submit" class="btn btn-all mrm30" id="log_in_spring_ajax" name="log_in">Log In &nbsp;
                                        <i class="fa fa-chevron-right"></i>
                                    </button>
                                    <button type="button" class="btn btn-all-learn" name="sign_up_link" id="sign_up_link_ajax" value="click here"
                                            onclick="onJoinInClicked('member_login_spring_ajax')">
                                        Join in &nbsp;
                                        <i class="fa fa-chevron-right"></i>
                                    </button>
                                    <hr>
                                    <a href="#" data-toggle="modal" data-target="#member-forget-psd" class="link-log-in" onClick="$('#member_login_close').trigger('click')">Forgot Password</a>
                                </div>
                            </div>

                        </form>

                    </div>
                </div>

            </div>

        </div>
    </div>
</div>
<div class="modal fade" id="member_login" role="dialog">
    <div class="container">
        <div class="row">
            <div class="modal-dialog">
                <div class="modal-content modal-member mw370">
                    <div class="modal-header modal-header-member text-left xs-text-left">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="member_login_close"><span aria-hidden="true">&times;</span></button>
                        <img src="/afya-portal/static/images/popup-logo2.png" alt="logo" class=""/>
                        <span class="modal-head mrm30" style="margin-left:50px">Member Login</span>
                    </div>
                    <div class="modal-body pd30">
                        <div style="display:none" class="login-error-box text-center">
                            <!--succe-box-->
                            <img src="/afya-portal/static/images/error-icon.png" alt="error-img"/> &nbsp;<span>Please fix the errors in the form.</span>
                        </div>
                        <form class="form_member_login" id="form_member_login_spring" method="post">
                            <div class="form-group mb30">
                                <div class="input-icon">
                                    <i class="fa fa-user"></i>
                                    <input type="text" class="form-control fsize" id="username1" name="USERNAME" placeholder="Username"/>
                                </div>
                            </div>
                            <div class="form-group mb30">
                                <div class="input-icon">
                                    <i class="fa fa-key"></i>
                                    <input type="password" class="form-control fsize" id="password1" name="PASSWORD1" placeholder="Password" oncopy="return false;" onpaste="return false;" oncut="return false;"/>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <div class="mb20">
                                    <button type="button" class="btn btn-all mrm30" id="log_in_popup" name="log_in">Log In &nbsp;
                                        <i class="fa fa-chevron-right"></i>
                                    </button>
                                    <button type="button" class="btn btn-all-learn" name="sign_up_link" id="sign_up_link" value="click here"
                                         onclick="onJoinInClicked()">
                                        Join in &nbsp;
                                        <i class="fa fa-chevron-right"></i>
                                    </button>
                                    <hr>
                                    <a href="#" data-toggle="modal" data-target="#member-forget-psd" class="link-log-in" onClick="$('#member_login_close').trigger('click')">Forgot Password</a>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>

            </div>

        </div>
    </div>
</div>
<!-- Small modal end-->


<!-- member login Small modal start-->
<div  class="modal fade" id="member-forget-psd" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="container" ng-init="display()">
            <div class="row">
                <div class="modal-dialog">
                    <div class="modal-content modal-member mw370">
                        <div class="modal-header modal-header-member text-center xs-text-left">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="member_pass_close"><span aria-hidden="true">&times;</span></button>
                            <img src="/afya-portal/static/images/popup-logo2.png" alt="logo" class=""/>
                            <span class="modal-head mrm30">Forgot password</span>
                        </div>
                        <div class="modal-body pd30">
                            <div style="display:none" class="login-error-box text-center">
                                <!--succe-box-->
                                <img src="/afya-portal/static/images/error-icon.png" alt="error-img"/> &nbsp;<span>Please fix the errors in the form.</span>
                            </div>
                            <form class="form_member_login" id="form_member_login" method="post">
                                <div class="form-group mb30">
                                    <input type="email" class="form-control fsize required" id="email_username" name="email_username" onclick="hideErr()"
                                           placeholder="User Name"/>
                                    <p id="errmsg"></p>
                                </div>
                                <div class="modal-footer">
                                    <div class="mb20">
                                        <button type="button" class="btn btn-all mrm30" id="log_in" name="log_in" onclick="display()">Submit&nbsp;
                                            <i class="fa fa-chevron-right"></i>
                                        </button>
                                        <!--<button type="button" class="btn btn-all-learn" name="sign_up_link" id="sign_up_link" value="click here"
                                                onClick="window.location.href='join-in.html'">
                                            Join in &nbsp;
                                            <i class="fa fa-chevron-right"></i>
                                        </button>-->
                                        <hr>
                                        <span class="link-forget-pass">Please enter your Username </span>

                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>

                </div>

            </div>
        </div>
<!--    <script src="/afya-portal/static/js/angular.min.js"></script>
    <script src="/afya-portal/static/js/angular-messages.min.js"></script>-->
    <!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>-->
    <!--<script src="/afya-portal/static/js/jquery.js" type="text/javascript"></script>-->
    <script src="/afya-portal/static/js/ForgotPassword.js"></script>
</div>
<!-- Small modal end-->

<div class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <button class="close" aria-label="Close" data-dismiss="modal" type="button">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 id="mySmallModalLabel" class="modal-title"><img src="/afya-portal/static/images/popup-logo2.png" alt="logo" class=""/></h4>
            </div>

            <div class="modal-body  text-center pd30" > <p class="text-para">We will get back to you soon.</p> </div>
        </div>

    </div>
</div>

<div class="modal fade bs-example-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel1" id="mySmallModalLabel2">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <button class="close" aria-label="Close" data-dismiss="modal" type="button">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 id="mySmallModalLabel1" class="modal-title"><img src="/afya-portal/static/images/popup-logo2.png" alt="logo" class=""/></h4>
            </div>

            <div class="modal-body  text-center pd30" > <h2 style="color:rgb(67,182,230)">Afya Services to be Launched Soon</h2> </div>
        </div>

    </div>
</div>

<div class="modal fade bs-example-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel3" id="mySmallModalComingSoonPharmacy">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <button class="close" aria-label="Close" data-dismiss="modal" type="button">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 id="mySmallModalLabel3" class="modal-title"><img src="/afya-portal/static/images/popup-logo2.png" alt="logo" class=""/></h4>
            </div>

            <div class="modal-body  text-center pd30" > <h2 style="color:rgb(67,182,230)">Coming soon for Pharmacy</h2> </div>
        </div>
    </div>
</div>

<div class="modal fade bs-example-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel4" id="mySmallModalMyFacilitySubscribe">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <button class="close" aria-label="Close" data-dismiss="modal" type="button">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 id="mySmallModalLabel4" class="modal-title"><img src="/afya-portal/static/images/popup-logo2.png" alt="logo" class=""/></h4>
            </div>

            <div class="modal-body  text-center pd30" > <span style="color:#000000; font-weight: bold;">Subscribe immediately Afya Services & enjoy the power of being part of the Community</span> </div>
        </div>
    </div>
</div>

<style>
    .sweet-alert p {
        color: red;
        font-size: 16px;
        font-weight: 300;
        position: relative;
        text-align: inherit;
        float: none;
        margin: 0;
        padding: 0;
        line-height: normal;
    }
</style>
<script type="text/javascript">
    $(document).ready(function () {
        /* on click of submit */
        $("#log_in_spring").on("click", function (e) {
            /* validate all inputs first */
            var username = $('#username_spring').val();
            var password = $('#password_spring').val();
            var facility_type = $('#facility_type').find(":selected").text();
            var client_name = $('#client_name').val();
            if (username == '') {
                $('#username').addClass('inputName');
                $('#username').removeClass('input');
                $('#username').focus();
                return false;
            }
            if (password == '') {
                $('#password').addClass('inputName');
                $('#password').removeClass('input');
                $('#password').focus();
                return false;
            }

            $('#frm_member_login').submit();
        });

        $('#loginform').submit(function (event) {
		event.preventDefault();
		var url= location.href;
		//alert(url);
		var data = 'username=' + $('#username').val() + '&password=' + $('#password').val();
		//alert(data);
		$.ajax({
			data: data,
			timeout: 1000,
			type: 'POST',
			url: '/afya-portal/login'
		}).done(function(data, textStatus, jqXHR) {
		 $("#member_login_spring_ajax").modal("hide");
			loginSuccessHandler(url);

		}).fail(function(jqXHR, textStatus, errorThrown) {
		    var errormessage= JSON.parse(jqXHR.responseText)
            //alert(errormessage.message);
			//alert('Booh! Wrong credentials, try again!');
			console.log(errormessage);
            sweetAlert({ title: "Sorry", text: errormessage.message, type: "error" });
		});
	});


        $('#log_in_popup').on('click', function(){
            var username = $("#username").val();
            var password = $("#password1").val();
            password = encodeURIComponent(password);    // Fix login with password having '&'
            if(validateInput(username, password)){

                $.ajax({
                    url : '/afya-portal/loginViaPopUp?username='+username+'&password='+password,
                    method : 'POST',
                    contentType:"application/json",
                    Accept : "application/json",
                    //data : JSON.stringify({username : username, password : password}),
                    success : function(data){
                        $("#member_login").modal("hide");
                        var url = '';
                        loginSuccessHandler(url);
                        //location.reload();
                    },
                    error : function(data){
                        console.log(data);
                        sweetAlert({ title: "Sorry", text: data.responseJSON.message, type: "error" });
                    }
                });
            }
        });



        function validateInput(username, password){
            if(username == ''){
                $scope.nameRequired = 'Full Name Required';
                $('#username').focus();
                return false;
            }
            if(password == ''){
                $scope.emailRequired = 'Email Required';
                $('#password').focus();
                return false;
            }
            return true;
        }
        //forget password
        $("#forgot_submit").on("click", function (e) {
            e.preventDefault();
            /* validate all inputs first */
            var forgot_username = $('#forgot_username').val();
            var forgot_facility_type = $('#forgot_facility_type').find(":selected").text();
            var forgot_client_name = $('#forgot_client_name').val();
            $('.error-box').attr('display', 'block');
            setTimeout(function () {
                $('.error-box').fadeIn();
            }, 1000);
            if (forgot_username == '') {
                $('#forgot_username').addClass('inputName');
                $('#forgot_username').removeClass('input');
                $('#forgot_username').focus();
                return false;
            }
            if (forgot_facility_type == '' || forgot_facility_type == 'Facility Type*') {
                $('#forgot_facility_type').addClass('inputName');
                $('#forgot_facility_type').removeClass('input');
                $('#forgot_facility_type').focus();
                return false;
            }
            if (forgot_client_name == '') {
                $('#forgot_client_name').addClass('inputName');
                $('#forgot_client_name').removeClass('input');
                $('#forgot_client_name').focus();
                return false;
            }
            if ($('#forgot_username').val() != "" || $('#forgot_facility_type').find(":selected").text() != "" || $('#forgot_client_name').val() != "") {
                sweetAlert("Validation successful");//alert('Validation successful');
                $('#forgot_username').val('');
                $('#forgot_facility_type').find(":selected").text('Facility Type*');
                $('#forgot_client_name').val('');
                setTimeout(function () {
                    $('.error-box').fadeOut();
                }, 1000);
            }
            else {
                 sweetAlert("error");//alert('error');
            }
        });
    });
</script>